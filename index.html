<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Blackjack + Contar Cartas Hi-Lo Mejorado</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap');
  :root {
    --bg-main: #1e1e2f;
    --bg-panel: #2c3e50;
    --text-main: #f0f0f5;
    --highlight: #f39c12;
    --green: #27ae60;
    --green-hover: #2ecc71;
    --red: #c0392b;
    --gray-disabled: #95a5a6;
    --shadow: rgba(0,0,0,0.7);
  }
  body {
    font-family: 'Roboto Mono', monospace, Arial, sans-serif;
    max-width: 520px;
    margin: 20px auto;
    background: var(--bg-main);
    color: var(--text-main);
    text-align: center;
    user-select: none;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  h1 {
    margin-bottom: 10px;
    color: var(--highlight);
    text-shadow: 0 0 8px var(--highlight);
  }
  #game {
    background: var(--bg-panel);
    border-radius: 12px;
    padding: 20px 25px 40px;
    box-shadow: 0 8px 25px var(--shadow);
  }
  .hand {
    margin: 15px 0 0 0;
  }
  .hand h3 {
    margin: 0 0 6px 0;
    color: #ecf0f1;
    font-weight: 600;
  }
  .cards {
    font-size: 56px;
    min-height: 70px;
    display: flex;
    justify-content: center;
    gap: 12px;
    user-select: none;
  }
  .card {
    background: linear-gradient(135deg, #fff 0%, #ddd 100%);
    border-radius: 8px;
    width: 48px;
    height: 70px;
    color: black;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 5px 6px;
    box-shadow: 0 3px 5px rgba(0,0,0,0.2);
    font-weight: 700;
    font-size: 18px;
    position: relative;
    user-select: none;
    transition: transform 0.3s ease;
  }
  .card.red {
    color: var(--red);
  }
  .card .corner {
    font-size: 14px;
  }
  #controls {
    margin: 20px 0 10px;
  }
  button {
    font-size: 18px;
    padding: 10px 20px;
    margin: 0 10px 10px 10px;
    cursor: pointer;
    border-radius: 8px;
    border: none;
    background-color: var(--green);
    color: white;
    box-shadow: 0 5px 10px rgba(39, 174, 96, 0.5);
    user-select: none;
    transition: background-color 0.3s ease;
  }
  button:disabled {
    background-color: var(--gray-disabled);
    box-shadow: none;
    cursor: default;
  }
  button:hover:not(:disabled) {
    background-color: var(--green-hover);
  }
  input[type="number"] {
    font-size: 18px;
    width: 100px;
    padding: 6px 10px;
    border-radius: 8px;
    border: none;
    text-align: center;
    margin-bottom: 10px;
  }
  #feedback, #countFeedback, #balanceDisplay, #roundDisplay {
    margin-top: 12px;
    min-height: 28px;
    font-weight: 600;
  }
  #balanceDisplay {
    font-size: 20px;
    color: var(--highlight);
    user-select: none;
  }
  #roundDisplay {
    font-size: 16px;
    color: #ecf0f1aa;
    margin-bottom: 8px;
  }
  #countSection {
    margin-top: 20px;
    border-top: 1px solid #3b5160;
    padding-top: 18px;
  }
  /* PANEL LATERAL */
  #sidePanelToggle {
    position: fixed;
    top: 50%;
    right: 0;
    background: var(--green);
    border-radius: 8px 0 0 8px;
    padding: 10px 12px;
    cursor: pointer;
    user-select: none;
    z-index: 1000;
    font-weight: 700;
    box-shadow: 0 3px 10px rgba(0,0,0,0.5);
    transition: background-color 0.3s ease;
  }
  #sidePanelToggle:hover {
    background: var(--green-hover);
  }
  #sidePanel {
    position: fixed;
    top: 0;
    right: -320px;
    width: 320px;
    height: 100%;
    background: var(--bg-panel);
    box-shadow: -5px 0 15px rgba(0,0,0,0.7);
    padding: 20px;
    overflow-y: auto;
    transition: right 0.3s ease;
    font-size: 14px;
    z-index: 999;
  }
  #sidePanel.open {
    right: 0;
  }
  #sidePanel h2 {
    margin-top: 0;
    color: var(--highlight);
    text-shadow: 0 0 6px var(--highlight);
    font-weight: 700;
    font-size: 22px;
  }
  .history-entry {
    margin-bottom: 16px;
    border-bottom: 1px solid #3b5160;
    padding-bottom: 10px;
  }
  .history-entry h3 {
    margin: 0 0 6px 0;
    font-weight: 600;
    color: #ecf0f1;
  }
  .history-cards {
    display: flex;
    gap: 6px;
    margin-bottom: 6px;
  }
  .history-cards .card {
    width: 36px;
    height: 52px;
    font-size: 14px;
    padding: 3px 4px;
  }
  .history-text {
    font-weight: 600;
    color: #ccc;
  }

  /* BOTONES DOBLAR y RENDIRSE */
  #btnDouble, #btnSurrender {
    background-color: #2980b9;
  }
  #btnDouble:hover:not(:disabled) {
    background-color: #3498db;
  }
  #btnSurrender {
    background-color: #e67e22;
  }
  #btnSurrender:hover:not(:disabled) {
    background-color: #d35400;
  }

  /* MODO DALTÓNICO */
  body.daltonic {
    --bg-main: #2b2b2b;
    --bg-panel: #3a3a3a;
    --text-main: #f0f0f0;
    --highlight: #f39c12;
    --green: #117a65;
    --green-hover: #16a085;
    --red: #922b21;
    --gray-disabled: #7f8c8d;
    --shadow: rgba(0,0,0,0.8);
  }
  body.daltonic .card.red {
    color: #0000ff; /* Azules para rojo */
  }
  /* ALTO CONTRASTE */
  body.highcontrast {
    background-color: black !important;
    color: yellow !important;
  }
  body.highcontrast #game {
    background-color: black !important;
    color: yellow !important;
  }
  body.highcontrast button {
    background-color: yellow !important;
    color: black !important;
    box-shadow: none !important;
  }
  body.highcontrast input[type="number"] {
    background-color: black !important;
    color: yellow !important;
    border: 2px solid yellow !important;
  }
  /* AJUSTE TAMAÑO */
  body.small-text {
    font-size: 12px;
  }
  body.large-text {
    font-size: 22px;
  }
</style>
</head>
<body>
<h1>Blackjack + Contar Cartas Hi-Lo Mejorado</h1>

<div>
  <label for="initialBalanceInput">Saldo inicial ($): </label><br/>
  <input type="number" id="initialBalanceInput" min="1" max="100000" value="1000" />
  <button id="btnSetBalance">Establecer saldo</button>
</div>

<div id="game">
  <div id="balanceDisplay">Saldo: $1000</div>
  <div id="roundDisplay">Ronda: 0</div>

  <div>
    <label for="betInput">Apuesta esta ronda ($):</label><br/>
    <input type="number" id="betInput" min="1" max="1000" value="50" />
  </div>

  <div id="controls">
    <button id="btnStart">Empezar ronda</button>
    <button id="btnHit" disabled>Pedir</button>
    <button id="btnStand" disabled>Basta</button>
    <button id="btnDouble" disabled>Doblar apuesta</button>
    <button id="btnSurrender" disabled>Rendirse</button>
    <button id="btnEndSession" style="background:#c0392b;">Terminar sesión</button>
  </div>

  <div class="hand">
    <h3>Tu mano (<span id="playerSum">0</span>)</h3>
    <div id="playerCards" class="cards"></div>
  </div>

  <div class="hand">
    <h3>Mano de la banca (<span id="dealerSum">0</span>)</h3>
    <div id="dealerCards" class="cards"></div>
  </div>

  <div id="feedback"></div>

  <div id="countSection" style="display:none;">
    <label for="countInput">Ingresa el conteo acumulado Hi-Lo final de toda la sesión:</label><br/>
    <input type="number" id="countInput" />
    <button id="btnSubmitCount">Enviar conteo</button>
    <div id="countFeedback"></div>
  </div>
</div>

<!-- Panel lateral toggle -->
<div id="sidePanelToggle">Historial</div>
<!-- Panel lateral -->
<div id="sidePanel" aria-label="Historial de cartas y apuestas">
  <h2>Historial Rondas y Apuestas</h2>
  <div id="historyContainer"></div>
  <hr />
  <h3>Resumen acumulado</h3>
  <p id="summaryStats"></p>
</div>

<!-- Sonidos -->
<audio id="soundCard" src="https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_drum_hit.ogg" preload="auto"></audio>
<audio id="soundButton" src="https://actions.google.com/sounds/v1/buttons/button_click.ogg" preload="auto"></audio>

<!-- Accesibilidad -->
<div style="margin-top:20px;">
  <button id="btnToggleDaltonic" title="Activar/desactivar modo daltónico">Modo Daltónico</button>
  <button id="btnToggleContrast" title="Alternar alto contraste">Alto Contraste</button>
  <button id="btnTextSmall" title="Texto pequeño">A-</button>
  <button id="btnTextNormal" title="Texto normal">A</button>
  <button id="btnTextLarge" title="Texto grande">A+</button>
</div>

<script>
(() => {
  // --- Datos y funciones base (originales adaptadas) ---
  const deckRanks = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
  const deckSuits = ['♠', '♥', '♦', '♣'];

  function hiLoValue(rank) {
    if(['2','3','4','5','6'].includes(rank)) return 1;
    if(['7','8','9'].includes(rank)) return 0;
    return -1;
  }

  function blackjackValue(rank) {
    if(['J','Q','K'].includes(rank)) return 10;
    if(rank === 'A') return 11;
    return parseInt(rank, 10);
  }

  let deck = [];
  function buildDeck() {
    deck = [];
    for(let suit of deckSuits) {
      for(let rank of deckRanks) {
        deck.push({rank, suit});
      }
    }
  }
  function shuffleDeck() {
    for(let i = deck.length - 1; i > 0; i--){
      const j = Math.floor(Math.random() * (i + 1));
      [deck[i], deck[j]] = [deck[j], deck[i]];
    }
  }

  // Estado juego
  let playerCards = [];
  let dealerCards = [];
  let runningCount = 0; // total de TODAS las cartas sacadas en la sesión
  let playerSum = 0;
  let dealerSum = 0;
  let gameOver = false;
  let balance = 1000;
  let round = 0;
  let currentBet = 0;
  let totalWon = 0; // Ganancias netas
  let totalLost = 0;

  // Historial por ronda
  let roundsHistory = []; // {round, playerCards[], dealerCards[], runningCountAfter, bet, result}

  // Elementos DOM
  const playerCardsDiv = document.getElementById('playerCards');
  const dealerCardsDiv = document.getElementById('dealerCards');
  const playerSumSpan = document.getElementById('playerSum');
  const dealerSumSpan = document.getElementById('dealerSum');
  const btnHit = document.getElementById('btnHit');
  const btnStand = document.getElementById('btnStand');
  const btnStart = document.getElementById('btnStart');
  const btnEndSession = document.getElementById('btnEndSession');
  const btnDouble = document.getElementById('btnDouble');
  const btnSurrender = document.getElementById('btnSurrender');
  const feedbackDiv = document.getElementById('feedback');
  const countInput = document.getElementById('countInput');
  const btnSubmitCount = document.getElementById('btnSubmitCount');
  const countFeedback = document.getElementById('countFeedback');
  const balanceDisplay = document.getElementById('balanceDisplay');
  const roundDisplay = document.getElementById('roundDisplay');
  const betInput = document.getElementById('betInput');
  const countSection = document.getElementById('countSection');
  const initialBalanceInput = document.getElementById('initialBalanceInput');
  const btnSetBalance = document.getElementById('btnSetBalance');
  const sidePanelToggle = document.getElementById('sidePanelToggle');
  const sidePanel = document.getElementById('sidePanel');
  const historyContainer = document.getElementById('historyContainer');
  const summaryStats = document.getElementById('summaryStats');
  const soundCard = document.getElementById('soundCard');
  const soundButton = document.getElementById('soundButton');

  // Accesibilidad botones
  const btnToggleDaltonic = document.getElementById('btnToggleDaltonic');
  const btnToggleContrast = document.getElementById('btnToggleContrast');
  const btnTextSmall = document.getElementById('btnTextSmall');
  const btnTextNormal = document.getElementById('btnTextNormal');
  const btnTextLarge = document.getElementById('btnTextLarge');

  // Funciones utilitarias
  function cardToString(card) {
    return card.rank + card.suit;
  }
  function isRedSuit(suit) {
    return suit === '♥' || suit === '♦';
  }
  function createCardElement(card) {
    const div = document.createElement('div');
    div.classList.add('card');
    if(isRedSuit(card.suit)) div.classList.add('red');
    div.innerHTML = `<div class="corner top-left">${card.rank}${card.suit}</div>
                     <div class="corner bottom-right">${card.rank}${card.suit}</div>`;
    return div;
  }
  function calculateSum(cards) {
    let sum = 0;
    let aceCount = 0;
    for(let c of cards) {
      sum += blackjackValue(c.rank);
      if(c.rank === 'A') aceCount++;
    }
    while(sum > 21 && aceCount > 0) {
      sum -= 10;
      aceCount--;
    }
    return sum;
  }
  function playSound(sound) {
    if(sound) {
      sound.currentTime = 0;
      sound.play();
    }
  }

  // Mostrar cartas y sumas
  function updateDisplay(showDealerSum = false) {
    playerCardsDiv.innerHTML = '';
    dealerCardsDiv.innerHTML = '';

    playerCards.forEach(card => {
      playerCardsDiv.appendChild(createCardElement(card));
    });
    dealerCards.forEach(card => {
      dealerCardsDiv.appendChild(createCardElement(card));
    });

    playerSumSpan.textContent = playerSum;
    dealerSumSpan.textContent = showDealerSum ? dealerSum : '?';
  }

  // Extraer carta, actualizar running count y tocar sonido
  function drawCard() {
    if(deck.length === 0) {
      feedbackDiv.textContent = 'No quedan cartas en la baraja. Se rebaraja automáticamente.';
      buildDeck();
      shuffleDeck();
    }
    const card = deck.pop();
    runningCount += hiLoValue(card.rank);
    playSound(soundCard);
    return card;
  }

  // Termina ronda con resultado y ajuste de saldo, historial y feedback
  function endGame(outcome, resultType) {
    gameOver = true;
    btnHit.disabled = true;
    btnStand.disabled = true;
    btnDouble.disabled = true;
    btnSurrender.disabled = true;
    btnStart.disabled = false;
    betInput.disabled = false;

    feedbackDiv.style.color = (resultType === 'win') ? '#2ecc71' : (resultType === 'lose' ? '#e74c3c' : '#f39c12');
    feedbackDiv.textContent = outcome;

    if(resultType === 'win') {
      balance += currentBet;
      totalWon += currentBet;
    } else if(resultType === 'lose') {
      balance -= currentBet;
      totalLost += currentBet;
    } else if(resultType === 'surrender') {
      balance -= Math.ceil(currentBet / 2);
      totalLost += Math.ceil(currentBet / 2);
    }
    balanceDisplay.textContent = `Saldo: $${balance}`;
    roundDisplay.textContent = `Ronda: ${round}`;

    // Guardar en historial
    roundsHistory.push({
      round,
      playerCards: [...playerCards],
      dealerCards: [...dealerCards],
      runningCountAfter: runningCount,
      bet: currentBet,
      result: outcome,
      resultType
    });

    updateHistoryPanel();
  }

  // Iniciar ronda nueva
  function startRound() {
    currentBet = parseInt(betInput.value, 10);
    if(isNaN(currentBet) || currentBet < 1) {
      feedbackDiv.style.color = 'red';
      feedbackDiv.textContent = 'Ingresa una apuesta válida mayor a 0.';
      return;
    }
    if(currentBet > balance) {
      feedbackDiv.style.color = 'red';
      feedbackDiv.textContent = 'No tienes suficiente saldo para esa apuesta.';
      return;
    }
    feedbackDiv.style.color = 'white';
    feedbackDiv.textContent = '';
    betInput.disabled = true;
    btnStart.disabled = true;
    countSection.style.display = 'none';
    countInput.value = '';
    countInput.disabled = true;
    btnSubmitCount.disabled = true;
    round++;
    playerCards = [];
    dealerCards = [];
    gameOver = false;
    buildDeck();
    shuffleDeck();

    playerCards.push(drawCard());
    dealerCards.push(drawCard());
    playerCards.push(drawCard());
    dealerCards.push(drawCard());

    playerSum = calculateSum(playerCards);
    dealerSum = calculateSum(dealerCards);

    updateDisplay(false);

    btnHit.disabled = false;
    btnStand.disabled = false;
    btnDouble.disabled = false;
    btnSurrender.disabled = false;

    // Blackjack chequeo
    if(playerSum === 21 || dealerSum === 21) {
      btnHit.disabled = true;
      btnStand.disabled = true;
      btnDouble.disabled = true;
      btnSurrender.disabled = true;
      let outcome;
      let resultType;
      if(playerSum === 21 && dealerSum !== 21) {
        outcome = '¡Blackjack! Ganaste.';
        resultType = 'win';
      } else if(dealerSum === 21 && playerSum !== 21) {
        outcome = 'La banca tiene Blackjack. Perdiste.';
        resultType = 'lose';
      } else {
        outcome = 'Empate con Blackjack.';
        resultType = 'draw';
      }
      updateDisplay(true);
      endGame(outcome, resultType);
    }
  }

  // Evento PEDIR carta
  btnHit.addEventListener('click', () => {
    if(gameOver) return;
    playerCards.push(drawCard());
    playerSum = calculateSum(playerCards);
    updateDisplay(false);
    if(playerSum > 21) {
      updateDisplay(true);
      endGame('Te pasaste de 21. Perdiste.', 'lose');
    }
  });

  // Evento BASTA
  btnStand.addEventListener('click', () => {
    if(gameOver) return;
    while(dealerSum < 17) {
      dealerCards.push(drawCard());
      dealerSum = calculateSum(dealerCards);
    }
    updateDisplay(true);
    let outcome = '';
    let resultType = '';
    if(dealerSum > 21) {
      outcome = 'La banca se pasó. ¡Ganaste!';
      resultType = 'win';
    } else if(dealerSum === playerSum) {
      outcome = 'Empate.';
      resultType = 'draw';
    } else if(dealerSum > playerSum) {
      outcome = 'La banca gana.';
      resultType = 'lose';
    } else {
      outcome = '¡Ganaste!';
      resultType = 'win';
    }
    endGame(outcome, resultType);
  });

  // Evento DOBLAR APUESTA
  btnDouble.addEventListener('click', () => {
    if(gameOver) return;
    if(currentBet * 2 > balance) {
      feedbackDiv.style.color = 'red';
      feedbackDiv.textContent = 'No tienes saldo suficiente para doblar la apuesta.';
      return;
    }
    playSound(soundButton);
    currentBet *= 2;
    betInput.value = currentBet;
    betInput.disabled = true;
    btnDouble.disabled = true;
    btnSurrender.disabled = true;

    playerCards.push(drawCard());
    playerSum = calculateSum(playerCards);
    updateDisplay(false);

    if(playerSum > 21) {
      updateDisplay(true);
      endGame('Te pasaste de 21. Perdiste.', 'lose');
      return;
    }

    // La banca juega automáticamente después de doblar
    while(dealerSum < 17) {
      dealerCards.push(drawCard());
      dealerSum = calculateSum(dealerCards);
    }
    updateDisplay(true);
    let outcome = '';
    let resultType = '';
    if(dealerSum > 21) {
      outcome = 'La banca se pasó. ¡Ganaste!';
      resultType = 'win';
    } else if(dealerSum === playerSum) {
      outcome = 'Empate.';
      resultType = 'draw';
    } else if(dealerSum > playerSum) {
      outcome = 'La banca gana.';
      resultType = 'lose';
    } else {
      outcome = '¡Ganaste!';
      resultType = 'win';
    }
    endGame(outcome, resultType);
  });

  // Evento RENDIRSE
  btnSurrender.addEventListener('click', () => {
    if(gameOver) return;
    playSound(soundButton);
    updateDisplay(true);
    endGame('Te rendiste. Pierdes la mitad de la apuesta.', 'surrender');
  });

  // Evento EMPEZAR RONDA
  btnStart.addEventListener('click', () => {
    playSound(soundButton);
    startRound();
  });

  // Evento TERMINAR SESIÓN
  btnEndSession.addEventListener('click', () => {
    if(!gameOver){
      feedbackDiv.style.color = 'red';
      feedbackDiv.textContent = 'Termina la ronda actual antes de finalizar la sesión.';
      return;
    }
    btnHit.disabled = true;
    btnStand.disabled = true;
    btnStart.disabled = true;
    betInput.disabled = true;
    btnDouble.disabled = true;
    btnSurrender.disabled = true;
    btnEndSession.disabled = true;

    countSection.style.display = 'block';
    countInput.disabled = false;
    btnSubmitCount.disabled = false;
    feedbackDiv.style.color = 'white';
    feedbackDiv.textContent = 'Sesión terminada. Ingresa el conteo acumulado Hi-Lo final de toda la sesión.';
    countInput.focus();
  });

  // Evento ENVIAR CONTEO FINAL
  btnSubmitCount.addEventListener('click', () => {
    const userCount = parseInt(countInput.value, 10);
    if(isNaN(userCount)){
      countFeedback.style.color = 'red';
      countFeedback.textContent = 'Por favor, ingresa un número válido.';
      return;
    }
    if(userCount === runningCount){
      countFeedback.style.color = '#2ecc71';
      countFeedback.textContent = `¡Perfecto! El conteo correcto era ${runningCount}.`;
    } else {
      countFeedback.style.color = '#e67e22';
      countFeedback.textContent = `El conteo correcto es ${runningCount}.`;
    }
  });

  // ACTUALIZAR PANEL LATERAL DE HISTORIAL
  function updateHistoryPanel() {
    historyContainer.innerHTML = '';
    for(let r of roundsHistory) {
      const entry = document.createElement('div');
      entry.classList.add('history-entry');

      const title = document.createElement('h3');
      title.textContent = `Ronda ${r.round} - Apuesta: $${r.bet}`;
      entry.appendChild(title);

      const pcardsDiv = document.createElement('div');
      pcardsDiv.classList.add('history-cards');
      for(let c of r.playerCards) {
        const cardEl = createCardElement(c);
        cardEl.style.width = '36px';
        cardEl.style.height = '52px';
        cardEl.style.fontSize = '14px';
        pcardsDiv.appendChild(cardEl);
      }
      entry.appendChild(document.createTextNode('Jugador: '));
      entry.appendChild(pcardsDiv);

      const dcardsDiv = document.createElement('div');
      dcardsDiv.classList.add('history-cards');
      for(let c of r.dealerCards) {
        const cardEl = createCardElement(c);
        cardEl.style.width = '36px';
        cardEl.style.height = '52px';
        cardEl.style.fontSize = '14px';
        dcardsDiv.appendChild(cardEl);
      }
      entry.appendChild(document.createTextNode('Banca: '));
      entry.appendChild(dcardsDiv);

      const countText = document.createElement('p');
      countText.classList.add('history-text');
      countText.textContent = `Conteo acumulado Hi-Lo después: ${r.runningCountAfter}`;
      entry.appendChild(countText);

      const resultText = document.createElement('p');
      resultText.classList.add('history-text');
      resultText.textContent = `Resultado: ${r.result}`;
      entry.appendChild(resultText);

      historyContainer.appendChild(entry);
    }
    // Actualizar resumen
    summaryStats.textContent = 
      `Total ganado: $${totalWon} | Total perdido: $${totalLost} | Saldo actual: $${balance} | Rondas jugadas: ${roundsHistory.length}`;
  }

  // BOTÓN TOGGLE PANEL LATERAL
  sidePanelToggle.addEventListener('click', () => {
    playSound(soundButton);
    sidePanel.classList.toggle('open');
  });

  // BOTÓN PARA ESTABLECER SALDO INICIAL
  btnSetBalance.addEventListener('click', () => {
    let val = parseInt(initialBalanceInput.value, 10);
    if(isNaN(val) || val < 1) {
      alert('Ingresa un saldo inicial válido mayor a 0.');
      return;
    }
    balance = val;
    totalWon = 0;
    totalLost = 0;
    roundsHistory = [];
    round = 0;
    runningCount = 0;
    playerCards = [];
    dealerCards = [];
    gameOver = true;
    feedbackDiv.textContent = '';
    balanceDisplay.textContent = `Saldo: $${balance}`;
    roundDisplay.textContent = `Ronda: ${round}`;
    betInput.disabled = false;
    btnStart.disabled = false;
    btnHit.disabled = true;
    btnStand.disabled = true;
    btnDouble.disabled = true;
    btnSurrender.disabled = true;
    btnEndSession.disabled = false;
    countSection.style.display = 'none';
    countInput.value = '';
    countInput.disabled = true;
    btnSubmitCount.disabled = true;
    updateHistoryPanel();
  });

  // ACCESIBILIDAD - Cambiar modos visuales
  btnToggleDaltonic.addEventListener('click', () => {
    playSound(soundButton);
    document.body.classList.toggle('daltonic');
  });
  btnToggleContrast.addEventListener('click', () => {
    playSound(soundButton);
    document.body.classList.toggle('highcontrast');
  });
  btnTextSmall.addEventListener('click', () => {
    playSound(soundButton);
    document.body.classList.remove('large-text');
    document.body.classList.remove('normal-text');
    document.body.classList.add('small-text');
  });
  btnTextNormal.addEventListener('click', () => {
    playSound(soundButton);
    document.body.classList.remove('small-text');
    document.body.classList.remove('large-text');
  });
  btnTextLarge.addEventListener('click', () => {
    playSound(soundButton);
    document.body.classList.remove('small-text');
    document.body.classList.add('large-text');
  });

  // Inicialización
  balanceDisplay.textContent = `Saldo: $${balance}`;
  roundDisplay.textContent = `Ronda: ${round}`;
  btnHit.disabled = true;
  btnStand.disabled = true;
  btnDouble.disabled = true;
  btnSurrender.disabled = true;

})();
</script>
</body>
</html>